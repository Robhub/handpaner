(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{215:function(t,e,n){var content=n(251);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(40).default)("6b8e18ab",content,!0,{sourceMap:!1})},216:function(t,e,n){var content=n(253);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(40).default)("06c5724a",content,!0,{sourceMap:!1})},250:function(t,e,n){"use strict";n(215)},251:function(t,e,n){var r=n(39)(!1);r.push([t.i,"body{overflow:hidden}",""]),t.exports=r},252:function(t,e,n){"use strict";n(216)},253:function(t,e,n){var r=n(39)(!1);r.push([t.i,"div[data-v-2b5a5eef]{overflow:hidden}",""]),t.exports=r},282:function(t,e,n){"use strict";n.r(e);n(246);var r=n(0),o=n(193),data=n(95),h=r.a.extend({layout:"empty",head:function(){return{meta:[{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0"}]}},data:function(){return{paused:!0,tick:0,analyser:null,data:null,freqTarget:440,freqMin:200,freqMax:1200,val2color:[],canvasWidth:3840,visuWidth:1920,visuHeight:1080}},computed:{freqRange:function(){return this.freqMax-this.freqMin},canvasContext:function(){return this.$refs.visu.getContext("2d")}},mounted:function(){var t=this,e=this.$nuxt.$route.hash.substr(1),n=Object(o.l)(e,3),r=12*n.octave+data.d.indexOf(n.noteName);this.freqTarget=this.noteBaseToFreq(r),console.log("freq target",this.freqTarget);var h=this.$refs.visu;this.visuWidth=document.body.clientWidth,this.visuHeight=window.innerHeight,h.width=2*this.visuWidth,h.height=this.visuHeight,this.val2color=this.genColors([[0,0,0],[0,0,255],[0,255,255],[0,255,0],[255,255,0],[255,128,0],[255,0,0],[255,0,255],[255,255,255]]),navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){var n=new AudioContext,r=n.createMediaStreamSource(e);t.analyser=n.createAnalyser(),t.analyser.fftSize=8192,t.data=new Uint8Array(t.analyser.frequencyBinCount),r.connect(t.analyser),t.canvasContext.fillStyle="#000000",t.canvasContext.fillRect(0,0,h.width,h.height),t.processAudio()}))},methods:{noteBaseToFreq:function(t){return 440*Math.pow(2,(t-57)/12)},processAudio:function(){var t=this.$refs.visu;requestAnimationFrame(this.processAudio),this.paused||(this.analyser.getByteFrequencyData(this.data),this.drawTarget(),this.drawPeaks(),this.tick+=3,t.style.left="-"+this.tick%this.visuWidth+"px")},drawPeaks:function(){var t=this.canvasContext,e=this.tick%this.visuWidth,n=this.tick%this.visuWidth+this.visuWidth,r=this.analyser.frequencyBinCount,o=48e3/this.analyser.fftSize;this.canvasContext.fillStyle="#000",t.fillRect(e,0,3,this.visuHeight),t.fillRect(n,0,3,this.visuHeight),this.canvasContext.fillStyle="#fff";for(var b=1;b<r-1;b++){var h=this.data[b-1],c=this.data[b],l=this.data[b+1];if(c>h&&c>l&&c>150){var f=(b+this.interQuadratic(h,c,l))*o,d=this.freqToYPosition(f);t.fillRect(e,d,3,1),t.fillRect(n,d,3,1)}}},interQuadratic:function(t,e,n){return(t-n)/(2*(t-2*e+n))},freqToYPosition:function(t){return this.visuHeight-(t-this.freqMin)/this.freqRange*this.visuHeight},drawTarget:function(){this.canvasContext.fillStyle="#333",this.canvasContext.fillRect(0,this.freqToYPosition(this.freqTarget),this.canvasWidth,1),this.canvasContext.fillRect(0,this.freqToYPosition(2*this.freqTarget),this.canvasWidth,1),this.canvasContext.fillRect(0,this.freqToYPosition(3*this.freqTarget),this.canvasWidth,1)},drawSpectre:function(){for(var t=this.tick%this.visuWidth,e=this.tick%this.visuWidth+this.visuWidth,n=this.canvasContext,r=this.analyser.frequencyBinCount,o=0;o<this.visuHeight;o++){var h=(this.freqMin+o/this.visuHeight*this.freqRange)*r/22050,c=this.data[Math.floor(h)],l=this.data[Math.ceil(h)],f=h-Math.floor(h),d=Math.round(c*(1-f)+l*f);n.fillStyle=this.val2color[d],n.fillRect(t,this.visuHeight-o,3,1),n.fillRect(e,this.visuHeight-o,3,1)}},genColors:function(t){for(var e=[],i=0;i<256;i++){var n=i/256*(t.length-1),r=t[Math.floor(n)],o=t[Math.ceil(n)],h=n-Math.floor(n),c=r[0]*(1-h)+o[0]*h,g=r[1]*(1-h)+o[1]*h,b=r[2]*(1-h)+o[2]*h;e[i]="rgb("+c+","+g+","+b+")"}return e}}}),c=(n(250),n(252),n(19)),component=Object(c.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("canvas",{ref:"visu",staticStyle:{position:"relative"},on:{click:function(e){t.paused=!t.paused}}})])}),[],!1,null,"2b5a5eef",null);e.default=component.exports}}]);